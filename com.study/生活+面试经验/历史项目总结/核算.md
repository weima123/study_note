### 一.业务背景
```
      目前公司主要业务是做员工费用报销的；客户在我们系统内产生的各类业务数据，需要在某些节点（比如：审批通过、审核通过）生成财务凭证推送给客户。不同的客户财务凭证的样式、凭证的生成规则都不一样；
  之前每当有需要用到财务核算功能的新客户上线时，我们都需要针对客户的核算业务单独开发一个核算服务，去处理财务凭证生成、推送的业务；这极大的延长了新项目交付的周期，另外也增加了公司的项目交付
  成本；因此*年*月*日公司决定开发统一的核算凭证，用来处理不同客户的核算需求。
  
  
````

### 二.业务架构
##### 1.业务架构
```
helios业务系统数据---->核算平台---->下游系统
```
##### 2.核算平台主要的模块
```
1) 预置核算字段模块
2）凭证模版样式定义模块
3）借贷定义模块：借贷方向定义、借贷金额定义
4）科目模块：科目定义、科目匹配规则定义
5）凭证内容提取模块
```
##### 三.核算平台主要功能
###### 1.承接上游的业务数据
```
 1）
 2）
```
###### 2.凭证内容提取-公式编辑器

```
1）四则运算
2）逻辑运算
3）函数运算
```
```

```
###### 3.凭证数据的存储
```
1)数据库动态字段列:支持不同客户对凭证字段个数的需求
2)固化字段：方便后续出报表、方便后续开放凭证相关的公共查询业务
```
###### 4.下游系统对接
```
1）文件：excel csv txt
2)接口对接：
```

### 三.代码架构
```
1.项目框架：springBoot + redis + springCloud-sleuth+springCloud-hytrix + mysql
2.项目开发速度保障：增量初始化、工厂模式（分录生成、分录导出）
3.项目高可用保障:缓存 、服务熔断、线程池
4.项目可扩展性保障：工厂模式支持支持后续快速接入新的凭证生成规则额
```


### 四、遇到的问题
#### 1.技术类问题
```
1.凭证生成耗时？线程池、缓存
2.自定义序列化？
3.sql优化？
4.公共代码抽离、业务解耦：多种凭证的生成
5.分布式锁：
6.配置数据预处理：
7.动态查询问题：
```
#### 2.非技术类问题
```
1.垮团队任务协调
2.及时沟通、向上反馈
3.根据用户反馈，提出一些产品的优化点 ---1.凭证预览 2.异常信息明确化方便测试 3.垮环境配置迁移
```

### 五.项目带来的收益
##### 1.公司
```
  减少了新项目交付的周期(使用了核算的平台项目交付周期基本由一个月缩减到了半个月），节约了公司成本
```

##### 2.个人
```
1.加强了自己垮团队写作的能力
2.由了一定的产品sense
```



